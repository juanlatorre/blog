{"data":{"markdownRemark":{"html":"<h1>Formulario de Contacto para Sitio Estático</h1>\n<p>Dado que este blog es un <em><em>sitio estático</em></em>, tuve que buscar alternativas para poder enviar un formulario de contacto sin la necesidad de tener backend o un servidor dedicado para eso.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 650px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 89.08819133034379%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2ElEQVQ4y31UCW7cMAz0//9XNCiSXd+yLV+S70OeDrXJNgnaGuAOSWkpckQqcO7COE4YhhHTNFEfMVDWdcV1XXDOwXm8nvj0e3nY8+pwUg+uy2EaDKzpGXSAtRZd12OeZ3x88oe/4Wd92cEDgeDgb9IB60lZFgZa/AbJ9jydP2Tfd29v2+YPOs/THywiuvisMVj4/2BipFDPaOxKx4yZsm6rX9z2zdv7sYNFQqqRAFKq4Gf9OA6PgTimfsTYk8eO/BFNa4kDRiO29b59ObHz8M/lfi9fvkBILVWHPG5Q5C0abVHFI6pkhs5mlMS+XGDKGVO3MQL++Unw4HQn7vkdYR7ilt0QqRBJqhAnFeK4wO2m0LQNjO3Qdg2apvF0GHLW973nUXyC7xk66Mqg1oNHXckGi7ruUFWdR7GzrIZSjefqI5vv4gMKrgv7aHIel9kxg+vdJ/ZXXUrm3fj++xuXwcHW+HWvcU9bYoUwa3GLW0Tk8zVqcE9avLzWiMmz+F7eKryFBm9vI7TeeLhjO11fOVR1gVwrpFWGuEiQlpnXkyJloARZ+dBz7st0jqZrkTO44iEpE9HaPAchkKjGGjawZfMO6I2Q35LwxyUYTlClS05P+z6Gp5fj3DhqO/WD+u6b/hGQXAx69dKrGWO9Yu52LD2no90xC9Y711mePTA2K2y1eP/MNhL73Nznkh0SpSgFoiyHKjVUxZZROcI09Wsx/amsq4x7Mt56jzzhzccWaWSRZ48RfLZNSW4KTR7JlSpzxGnMIDEylSJKQq8neYKqLmGGHtM8kgpLGfgyTb615HV6cigjdewOB1M/9wsb7fO4vC548BZl/XokQd9/JkX6KUoNM7AIk55l8uaoq2rALWqZXc82aZ92qnrco55ZrXyFHG/3oPyZ8UBellt2x4/Xn7hx/FRXorYNyq5C3hZQbYmCPm1qr4uY0ZDHie0yoSxGlKU8yJt/5n4DBQVpwDPnn7oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"búsqueda de google\"\n        title=\"\"\n        src=\"/static/84f76a865bdbe4e2018a0b0146bd75a7/ccaa4/formulario-de-contacto-para-sitio-estatico-1.png\"\n        srcset=\"/static/84f76a865bdbe4e2018a0b0146bd75a7/4d3a0/formulario-de-contacto-para-sitio-estatico-1.png 163w,\n/static/84f76a865bdbe4e2018a0b0146bd75a7/c6041/formulario-de-contacto-para-sitio-estatico-1.png 325w,\n/static/84f76a865bdbe4e2018a0b0146bd75a7/ccaa4/formulario-de-contacto-para-sitio-estatico-1.png 650w,\n/static/84f76a865bdbe4e2018a0b0146bd75a7/39468/formulario-de-contacto-para-sitio-estatico-1.png 669w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span></p>\n<p>Obviamente al hacer la búsqueda en Google me encuentro con que la opción más usada y famosa es <a href=\"https://formspree.io\">Formspree</a>.</p>\n<blockquote>\n<h4>¿Qué es Formspree?</h4>\n<p>Connect your form to our endpoint and we’ll email you the submissions. No PHP, Javascript or sign up required —  <em>perfect for static sites!</em></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://formspree.io/your@email.com<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>  \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>_replyto<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Send<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span> \n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Así de sencillo, ya tendría funcionando un formulario de contacto en mi sitio estático, todo bien... pero no.</p>\n<p>Resulta que al enviar el formulario con Formspree, nos encontramos con esta maravilla.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 650px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 58.279009126466754%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABR0lEQVQoz5WT23KCMBCGff+X8Ul6YdUqHe0FYOUQQhJyAMaZv5s4YFGr9uInu+zmy2l31rYOXdfCj/fkY69oyJ35j7Uaxgh0rUbrmiBvO6fQNIJUX0kEaX2OGaNGaAA6p3HMUrwtF1hFH3jfrIMdfX1CSkaTKih1kf93URnAN8DvLMFys8Jqu0a0i4Id7baoqgyMHYO87eVBv+FayynQmAaiLlCxDDUvSHlQRZCiOKDID8jzdNQtUFwDFQU5jLWQSlKSJF9RQofTqcciKpGVAtb4++Mj6CFQSk4BDc457YyF0TkX4HGcoCyLCejJkVW43PMDcDT6vBPvC8HuPMTTRzFhlSBFsJqNpWGMfCg/x5fdCBwK0vjj0v3x/R7JfI74kCJNYlrMUrz7X2EHZ+gYa+AI3PcDxP3ZRdcdNdnhpNUIdi/5lRb8AQcLmB3ezbkqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"captcha\"\n        title=\"\"\n        src=\"/static/9ea69958321cc0788fef9404c80d77eb/ccaa4/formulario-de-contacto-para-sitio-estatico-2.png\"\n        srcset=\"/static/9ea69958321cc0788fef9404c80d77eb/4d3a0/formulario-de-contacto-para-sitio-estatico-2.png 163w,\n/static/9ea69958321cc0788fef9404c80d77eb/c6041/formulario-de-contacto-para-sitio-estatico-2.png 325w,\n/static/9ea69958321cc0788fef9404c80d77eb/ccaa4/formulario-de-contacto-para-sitio-estatico-2.png 650w,\n/static/9ea69958321cc0788fef9404c80d77eb/6f992/formulario-de-contacto-para-sitio-estatico-2.png 767w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span></p>\n<p>Un <strong><em>Captcha</em></strong> !!!!</p>\n<p>Definitivamente descartado, eliminar el anti-spam no es posible en el plan gratuito de formspree, entonces, ¿qué otra alternativa existe?</p>\n<p>Bueno, respuestas a esta pregunta hay muchas, servicios que hacen exactamente lo mismo como:</p>\n<ul>\n<li><a href=\"https://formkeep.com/\">FormKeep</a></li>\n<li><a href=\"https://liveformhq.com/\">LiveForm</a></li>\n<li><a href=\"https://formcarry.com/\">FormCarry</a></li>\n<li><a href=\"https://www.formbucket.com/\">FormBucket</a></li>\n</ul>\n<p>Pero buscando alternativas encontré algo que me llamó mucho la atención; es posible utilizar Google Docs para simular un backend y guardar el registro de mensajes en el formulario de contacto en una planilla, para luego enviarlo a mi correo.</p>\n<p>¿Overkill? Totalmente, pero interesante <em>as fuck</em>.</p>\n<p>Así que decidí implementarlo en el sitio siguiendo las instrucciones del siguiente repositorio -> <a href=\"https://github.com/dwyl/learn-to-send-email-via-google-script-html-no-server\">https://github.com/dwyl/learn-to-send-email-via-google-script-html-no-server</a></p>\n<ol>\n<li>Primero hay que copiar la <a href=\"https://docs.google.com/spreadsheets/d/1Bn4m6iA_Xch1zzhNvo_6CoQWqOAgwwkOWJKC-phHx2Q/copy\">siguiente planilla</a> en nuestra cuenta de Google Drive.</li>\n<li>Abrimos el <strong>Editor  de Secuencias de Comando</strong> haciendo click en <strong>Herramientas</strong> > <strong>Editor de Secuencias de Comando</strong>.</li>\n<li>Copiamos el siguiente <em>script</em> y editamos la variable <em>TO_ADDRESS</em>.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token constant\">TO_ADDRESS</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"mi@correo.com\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">doPost</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        MailApp<span class=\"token punctuation\">.</span><span class=\"token function\">sendEmail</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TO_ADDRESS</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Formulario de Contacto Enviado\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parameters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> ContentService<span class=\"token punctuation\">.</span><span class=\"token function\">createTextOutput</span><span class=\"token punctuation\">(</span>\n                <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"result\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>parameters<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">setMimeType</span><span class=\"token punctuation\">(</span>ContentService<span class=\"token punctuation\">.</span>MimeType<span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> ContentService\n            <span class=\"token punctuation\">.</span><span class=\"token function\">createTextOutput</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"result\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">:</span> e\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">setMimeType</span><span class=\"token punctuation\">(</span>ContentService<span class=\"token punctuation\">.</span>MimeType<span class=\"token punctuation\">.</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"4\">\n<li>Guardar el script como una <em>nueva versión</em>, para hacerlo, ir a <strong>Archivo</strong> > <strong>Administrar Versiones</strong>, ahí escribes un título y guardas la nueva versión.</li>\n<li>Publicar el script, para ello, vamos a <strong>Publicar</strong> > <strong>Implementar como aplicación web...</strong>, siempre fijarse en que la <em>Versión del Proyecto</em> sea la última.</li>\n<li>Apretar <em>Actualizar</em> y aceptar los correspondientes permisos, el resultado será una <em>URI</em>, guardar para el próximo paso.</li>\n</ol>\n<h3>HTML</h3>\n<p>Ahora que tenemos el formulario listo para recibir los mensajes, tenemos que implementarlo a un formulario html que debe cumplir con las siguientes condiciones:</p>\n<ul>\n<li>La clase del <code class=\"language-text\">&lt;form&gt;</code>debe ser <strong>gform</strong>.</li>\n<li>El atributo <em>name</em> de cada <code class=\"language-text\">&lt;input&gt;</code> debe ser el mismo que su correspondiente columna en la planilla de Google.</li>\n<li>El <em>action</em> del formulario debe ser la <em>URI</em> obtenida anteriormente.</li>\n</ul>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 650px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 45.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABU0lEQVQoz52R626DMAyFef+H2d/tKSZt9AItZVovUCBckgCl0PrMeEVr97ORPsX44GMncYoyoaJKadwrnVGmIgo2Hm1Cj/zVnNbBgmOfFstPyYVfK/L9Ga1Yy4sjlbfaycPhBCY4gTTdIwx9LH0X88UHlt4nVuu5xGyOIFjC81y47jvS7CA19x6OuDNTJzakPI8pzfZCpg6CNopUHommJBfRMdneTZlSyThTBxYQxd9QefzQla8Bx2QnTKeY8nKi25QTTqUVBwrWVtC6RNvW6M4ttCmgVCKaMb9a17U4nWpUVc6NU76eIw6HrWhnrjG2gDMWaq35w6BpajbSbG4xDD36vpf9Slfhcrkww4MmcHxlrW40nKa1GBfRCN3AU6s9N3Cs5XH7jkc+PTAe+4/TP1o5ftfzv8Zg2EYYdjFsEssr4yn4EXObodysUb+8Mm/Qsxl+APymqaQOO7FvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"ejemplo estatico\"\n        title=\"\"\n        src=\"/static/adb9bbf11b353dbfc0af76f97d36c9e6/ccaa4/formulario-de-contacto-para-sitio-estatico-3.png\"\n        srcset=\"/static/adb9bbf11b353dbfc0af76f97d36c9e6/4d3a0/formulario-de-contacto-para-sitio-estatico-3.png 163w,\n/static/adb9bbf11b353dbfc0af76f97d36c9e6/c6041/formulario-de-contacto-para-sitio-estatico-3.png 325w,\n/static/adb9bbf11b353dbfc0af76f97d36c9e6/ccaa4/formulario-de-contacto-para-sitio-estatico-3.png 650w,\n/static/adb9bbf11b353dbfc0af76f97d36c9e6/5ed4d/formulario-de-contacto-para-sitio-estatico-3.png 975w,\n/static/adb9bbf11b353dbfc0af76f97d36c9e6/9a5ee/formulario-de-contacto-para-sitio-estatico-3.png 1020w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span></p>\n<p>Con eso tenemos lista la integración, al probarlo obtuve algo como esto:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span><span class=\"token property\">\"result\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span><span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"{\\\"correo\\\":[\\\"juanlatorreharcha@gmail.com\\\"],\\\"mensaje\\\":[\\\"Hola, este es un mensaje de prueba.\\\"],\\\"telefono\\\":[\\\"973362531\\\"],\\\"nombre\\\":[\\\"Juan Latorre\\\"]}\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 650px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 28.75751503006012%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1UlEQVQY04WO224CMQxE8/+fWNHsLsnm1s2d9gXYwY4AtWpFoxzN2B5HEWY1cNYhOA9n7PCWesEH7Ncd++X6D/vIgW6vHUIeNKZ3jVkaSFJ5UFgmg2W28K4Q+QUF1kSoxeFIeVYhlQMzaQ9lI7RPWH0mzVjDX5QfcE659ES8SYdZBxzNNh4yoRL3Bf8bTT/TtGj9Bm08bGAfYd2Gj9ggYm5IpYN1S5WaZcD+QUxtzJnSPlH7F9qJ+K53L0rOqLWilIzeO1JKpG30TlTznJVr5nI+49W5AUQ/xjtu0l62AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"ejemplo mail recibido\"\n        title=\"\"\n        src=\"/static/8816956ce8d1d1310099ce6a71c50fcc/ccaa4/formulario-de-contacto-para-sitio-estatico-4.png\"\n        srcset=\"/static/8816956ce8d1d1310099ce6a71c50fcc/4d3a0/formulario-de-contacto-para-sitio-estatico-4.png 163w,\n/static/8816956ce8d1d1310099ce6a71c50fcc/c6041/formulario-de-contacto-para-sitio-estatico-4.png 325w,\n/static/8816956ce8d1d1310099ce6a71c50fcc/ccaa4/formulario-de-contacto-para-sitio-estatico-4.png 650w,\n/static/8816956ce8d1d1310099ce6a71c50fcc/5ed4d/formulario-de-contacto-para-sitio-estatico-4.png 975w,\n/static/8816956ce8d1d1310099ce6a71c50fcc/fa5f3/formulario-de-contacto-para-sitio-estatico-4.png 998w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span></p>\n<p>Perfecto, ahora solo falta mejorarlo un poco, no quiero que la persona que me contacta vea ese gran mensaje después de enviar el formulario.</p>\n<p>Para eso vamos a modificar un poco el script (primera parte, paso 2).</p>\n<p>Primero agrego la función <code class=\"language-text\">formatMailBody()</code> para mejorar un poco el <em>look</em> del correo recibido.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function formatMailBody(obj, order) {\n    var result = &quot;&quot;;\n    if (!order) {\n\t    order = Object.keys(obj);\n    }\n    for (var idx in order) {\n\t    var key = order[idx];\n\t    result += &quot;&lt;h4 style=&#39;text-transform: capitalize; margin-bottom: 0&#39;&gt;&quot; + key + &quot;&lt;/h4&gt;&lt;div&gt;&quot; + sanitizeInput(obj[key]) + &quot;&lt;/div&gt;&quot;;\n    }\n    return result;\n}</code></pre></div>\n<p>Pero esta función utiliza a su vez, otra función que limpia o sanitiza el <em>input</em> ingresado por la persona que quiere contartarme; así que agregaremos la función <code class=\"language-text\">sanitizeInput</code>también.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function sanitizeInput(rawInput) {\n    var placeholder = HtmlService.createHtmlOutput(&quot; &quot;);\n    placeholder.appendUntrusted(rawInput);\n    return placeholder.getContent();\n}</code></pre></div>\n<p>Y por supuesto teniendo dos nuevas funciones, hay que agregarlas a nuestro loop principal, que ahora queda así:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function doPost(e) {\n    try {\n\t    Logger.log(e);\n\t    record_data(e);\n\t    var mailData = e.parameters;\n\t    var orderParameter = e.parameters.formDataNameOrder;\n\t    var dataOrder;\n\t    if (orderParameter) {\n\t\t    dataOrder = JSON.parse(orderParameter);\n\t    }\n\t\tvar sendEmailTo = (typeof TO_ADDRESS !== &quot;undefined&quot;) ? TO_ADDRESS : mailData.formGoogleSendEmail;\n\t    if (sendEmailTo) {\n\t\t    MailApp.sendEmail({\n\t\t\t    to: String(sendEmailTo),\n\t\t\t    subject: &quot;Contact form submitted&quot;,\n\t\t\t    htmlBody: formatMailBody(mailData, dataOrder)\n\t\t    });\n\t    }\n\t    return ContentService.createTextOutput(\n\t\t    JSON.stringify({&quot;result&quot;:&quot;success&quot;,\n\t\t    &quot;data&quot;: JSON.stringify(e.parameters) }))\n\t\t\t   .setMimeType(ContentService.MimeType.JSON);\n    } catch(error) {\n\t    Logger.log(error);\n\t    return ContentService\n\t\t    .createTextOutput(JSON.stringify({&quot;result&quot;:&quot;error&quot;, &quot;error&quot;: error}))\n\t\t    .setMimeType(ContentService.MimeType.JSON);\n    }\n}</code></pre></div>\n<p>Sin embargo, nos falta la función para guardar los datos en la planilla creada al comienzo, por lo que la agregamos también.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function record_data(e) {\n  var lock = LockService.getDocumentLock();\n  lock.waitLock(30000);\n  \n  try {\n    Logger.log(JSON.stringify(e));\n    var doc = SpreadsheetApp.getActiveSpreadsheet();\n    var sheetName = e.parameters.formGoogleSheetName || &quot;responses&quot;;\n    var sheet = doc.getSheetByName(sheetName);\n    \n    var oldHeader = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];\n    var newHeader = oldHeader.slice();\n    var fieldsFromForm = getDataColumns(e.parameters);\n    var row = [new Date()];\n    \n    // loop through the header columns\n    for (var i = 1; i &lt; oldHeader.length; i++) {\n      var field = oldHeader[i];\n      var output = getFieldFromData(field, e.parameters);\n      row.push(output);\n      \n      var formIndex = fieldsFromForm.indexOf(field);\n      if (formIndex &gt; -1) {\n        fieldsFromForm.splice(formIndex, 1);\n      }\n    }\n    \n    for (var i = 0; i &lt; fieldsFromForm.length; i++) {\n      var field = fieldsFromForm[i];\n      var output = getFieldFromData(field, e.parameters);\n      row.push(output);\n      newHeader.push(field);\n    }\n    \n    var nextRow = sheet.getLastRow() + 1;\n    sheet.getRange(nextRow, 1, 1, row.length).setValues([row]);\n\n    if (newHeader.length &gt; oldHeader.length) {\n      sheet.getRange(1, 1, 1, newHeader.length).setValues([newHeader]);\n    }\n  }\n  catch(error) {\n    Logger.log(error);\n  }\n  finally {\n    lock.releaseLock();\n    return;\n  }\n\n}\n\nfunction getDataColumns(data) {\n  return Object.keys(data).filter(function(column) {\n    return !(column === &#39;formDataNameOrder&#39; || column === &#39;formGoogleSheetName&#39; || column === &#39;formGoogleSendEmail&#39; || column === &#39;honeypot&#39;);\n  });\n}\n\nfunction getFieldFromData(field, data) {\n  var values = data[field] || &#39;&#39;;\n  var output = values.join ? values.join(&#39;, &#39;) : values;\n  return output;\n}</code></pre></div>\n<p>y <em>voilá</em>, tenemos un formulario de contacto estático completamente de una forma completamente innecesaria.</p>","frontmatter":{"title":"Formulario de Contacto para Sitio Estático"}}},"pageContext":{"slug":"/blog/formulario-de-contacto-para-sitio-estatico/"}}